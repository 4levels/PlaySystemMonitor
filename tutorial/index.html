<html>
    <head>
        <title>Play System Monitor tutorial</title>
    </head>
    <body>
        <div>
            <h2>Play System Monitor</h2>
            <p>
               This Application demonstrates the importance of Event streams.
                Taking data from the server located at data center to the Network monitoring center
                is defacto now a days. Data analytics plays a crucial role in businesses.
                A stitch in time saves nine applies here.So, Taking the data from the server to web browser 
                and showing data in terms of Charts is very important for easy comprehension.
            </p>
            <p>
                <p>
                    The <code>Top</code> command data is exposed to javascript client
                    and chart js is used to present the data in terms of charts
                </p>
                
                <code>AvailableStreams.taskSummary</code> adapted to <code>EventSource</code> 
                the java script code at <a href="#code/views/index.scala.html">index.scala.html</a> contains
                the <code>@routes.Application.taskSummary()</code> which points to the taskSummary action in the application controllerms of Doughnut Pie
                charts in this application.
            </p>
        </div>
        <div>
            <h2>Event Source</h2>
            <p>
                <a href="#code/controllers/Application.scala" class="shortcut">
                    Application.scala
                </a> contains actions of different event streams and the below is the tasks event stream
            </p>
            <code>
                def taskSummary() = Action {
                    Ok.chunked(AvailableStreams.taskSummary &> EventSource()).as(EVENT_STREAM)
                }
            </code>
            <p>
                take <code>AvailableStreams.taskSummary</code> pass it to <code>EventSource</code> to adapt it into event source
                the java script code at <a href="#code/views/index.scala.html" class="shortcut">index.scala.html</a> contains
                the <code>@routes.Application.taskSummary()</code> points to the taskSummary action in the application controller
            </p>
        </div>
    
        <div>
            <h2>Reactive Data Streaming</h2>
            <p>
                <a href="#code/streams/AvailableStreams.scala" class="shortcut">Streams of <code>Top</code> linux command data</a>
                <code>
                    def iterator = s"top -c -u ${System.getProperty("user.name")} -b".lines_!.iterator
                </code>
                Iterator is got from the process by executing it using <code>sys.process._</code>scala api
                and then 
                <code>
                    def statsMemSorted: Enumerator[String] = Enumerator.enumerate(iterator)
                </code>
                Enumerator is produced from the iterator
                <code>
                    def taskSummary: Enumerator[JsValue] = statsMemSorted &> Enumeratee.mapInput[String] {
                        case Input.El(line) if line contains "Tasks" => {
                            val pieces = line.split("\\s+")
                            implicit def toInt(str: String) = str.toInt
                            Input.El(Json.toJson(TaskSummary(pieces(1), pieces(3), pieces(5), pieces(7), pieces(9))))
                        }
                    case Input.EOF => Input.EOF
                    case other => Input.Empty
                    }
                </code>
                Now the data is extracted from the line and then wrapped into an case class and sent out as json
            </p>
        </div>
    </body>
</html>